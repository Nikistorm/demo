webpackJsonp([1],{NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("7+uW"),s=i("QFcC"),a=i.n(s),o=i("l4u9"),d={name:"luckycoins",data:function(){return{title:"DragonStorm",game:null,isLandscape:!1,iosUrl:"https://play.google.com/store/apps/details?id=com.dsfgland.goat&hl=zh",androidUrl:"https://play.google.com/store/apps/details?id=com.dsfgland.goat&hl=zh",userAgent:""}},mounted:function(){this.setAgent(),this.checkAPI()},methods:{loadFont:function(){new FontFaceObserver("PassionOne").load().then(function(){console.log("font has loaded")})},setAgent:function(){var t=navigator.userAgent||navigator.vendor;/(iPhone|iPad|iPod|iOS)/i.test(t)?this.userAgent="ios":this.userAgent="android",console.log("%c USER_AGENT: %c "+this.userAgent+" ","color:#008080","background:#008080;color:#fff;font-size:16px;"),document.title=this.title},checkAPI:function(){console.log("gameStart");var t=this;function e(){console.log("%c mraid ready","color:pink"),mraid.addEventListener("viewableChange",function(e){t.showPlayable()})}function i(){console.log("%c dapi ready","color:pink");function t(t){if(console.log("isViewable "+t.isViewable),t.isViewable){dapi.getScreenSize();dapi.getAudioVolume()}}function e(t){t,console.log("ad was resibuyzed width "+t.width+" height "+t.height)}dapi.removeEventListener("ready",i),dapi.isViewable()&&t({isViewable:!0}),dapi.getAudioVolume(),dapi.addEventListener("viewableChange",t),dapi.addEventListener("adResized",e),dapi.addEventListener("audioVolumeChange",e)}"undefined"!=typeof mraid?"loading"===mraid.getState()?mraid.addEventListener("ready",e):e():"undefined"!=typeof dapi?(dapi.isReady()?i():dapi.addEventListener("ready",i),t.showPlayable()):t.showPlayable()},showPlayable:function(){this.init()},init:function(){var t=this,e=this,i=this.getCanvasSize(),n=i.canvasWidth,s=i.canvasHeight,d=[{username:"魔导师",desc:"战场支援领袖人物\n圣术与魔法之力的强强组合"},{username:"烈焰火女",desc:"自如操纵烈焰的伟力\n蕴藏着毁灭天地的超强魔力"},{username:"女战士",desc:"娴熟的战斗技能\n誓死捍卫团队荣耀"},{username:"黑暗破坏神",desc:"致命的刺客大师\n征讨一切暗黑之力"},{username:"萝莉炮台",desc:"在迷人可爱的外表下\n蕴藏着毁灭天地的超强战斗力"},{username:"黄金射手",desc:"箭术精湛的精灵射手\n致命的刺客大师"}],r=new a.a.Class({Extends:a.a.Scene,initialize:function(){a.a.Scene.call(this,{key:"GameScene"}),this.mainBodyX=.5*n,this.nextBodyX=n+414,this.prevBodyX=-414,this.personIndex=0,this.selectedNum=0,this.selectedPerson=[],this.status="play"},preload:function(){var t=this;["bg","platform","banner_wrap","hand","banner_line","end_btn","logo"].forEach(function(e){t.load.image(e,"./static/dragon/"+e+".png")}),this.load.audio("audio_button","./static/dragon/audio_button.mp3");[{srcName:"button_wrap",frameWidth:100,frameHeight:41},{srcName:"progress",frameWidth:260,frameHeight:13},{srcName:"ribbon",frameWidth:30,frameHeight:30},{srcName:"body",frameWidth:414,frameHeight:600},{srcName:"wing",frameWidth:414,frameHeight:600},{srcName:"dragon",frameWidth:200,frameHeight:140},{srcName:"end_bg",frameWidth:414,frameHeight:736}].forEach(function(e){t.load.spritesheet(e.srcName,"./static/dragon/"+e.srcName+".png",{frameWidth:e.frameWidth,frameHeight:e.frameHeight})})},create:function(){var t=this;this.sound=this.sound.add("audio_button"),this.bg=this.add.image(0,0,"bg").setOrigin(0),this.platform=this.add.image(0,0,"platform"),this.main_wing=this.add.image(0,0,"wing",0),this.main_body=this.add.image(0,0,"body",0),this.next_wing=this.add.image(0,0,"wing",1),this.next_body=this.add.image(0,0,"body",1),this.button_like=this.add.sprite(0,0,"button_wrap",0),this.button_unlike=this.add.sprite(0,0,"button_wrap",1),this.progress_wrap=this.add.image(0,0,"progress",0),this.progress_inner=this.add.image(0,0,"progress",1),this.text_favor=this.add.text(0,0,"好感度",{fontSize:14,color:"#ffffff",fontFamily:"Arial,Black"}).setOrigin(.5),this.text_tip=this.add.text(0,0,"选一个喜欢的人物好感度增加20%",{fontSize:14,color:"#ffffff",fontFamily:"Arial,Black"}).setOrigin(.5),this.text_like=this.add.text(0,0,"喜欢",{fontSize:13,color:"#d3bd66",fontFamily:"Arial,Black"}).setOrigin(.5),this.text_unlike=this.add.text(0,0,"不喜欢",{fontSize:13,color:"#d3bd66",fontFamily:"Arial,Black"}).setOrigin(.5),this.banner_wrap=this.add.image(0,0,"banner_wrap"),this.particles=this.add.particles("ribbon"),this.progress_g=this.make.graphics(),this.progress_g.fillStyle(16711680),this.bannerCont=this.add.container(),this.bannerCont.add(this.banner_wrap),this.username=this.add.text(-90,-30,d[this.personIndex].username,{fontSize:18,color:"#ffffff",fontFamily:"Arial,Black"}).setOrigin(.5),this.userdesc=this.add.text(-90,6,d[this.personIndex].desc,{fontSize:13,color:"#ffffff",fontFamily:"Arial,Black",align:"center"}).setOrigin(.5,0),this.dragon=this.add.image(90,0,"dragon",0),this.banner_line=this.add.image(-90,-20,"banner_line"),this.bannerCont.add([this.username,this.banner_line,this.userdesc,this.dragon]),this.hand=this.add.image(0,0,"hand").setScale(.8),this.endCont=this.add.container(),this.endCont.setVisible(!1),this.end_bg=this.add.image(0,0,"end_bg",0).setOrigin(0),this.end_btn_0=this.add.container(),this.end_btn_1=this.add.container(),this.word_start=this.add.text(0,1,"开始游戏",{fontSize:18,color:"#ffffff",fontFamily:"Arial,Black"}).setOrigin(.5),this.word_again=this.add.text(0,1,"再玩一次",{fontSize:18,color:"#ffffff",fontFamily:"Arial,Black"}).setOrigin(.5),this.end_btn_00=this.add.image(0,0,"end_btn"),this.end_btn_01=this.add.image(0,0,"end_btn"),this.end_btn_0.add(this.end_btn_00),this.end_btn_1.add(this.end_btn_01),this.end_btn_0.add(this.word_start),this.end_btn_1.add(this.word_again),this.logo=this.add.image(0,0,"logo"),this.endMain=this.add.container(),this.endCont.add([this.end_bg,this.endMain,this.end_btn_0,this.end_btn_1,this.logo]),this.setClickable(this.logo),this.setClickable(this.end_btn_00),this.setClickable(this.end_btn_01),this.refreshGame(),this.scale.on("resize",this.resize,this),this.button_like.setInteractive(),this.button_like.on("pointerdown",function(){t.handleUserSelect("like")},this),this.button_unlike.setInteractive(),this.button_unlike.on("pointerdown",function(){t.handleUserSelect("unlike")},this),this.start_tween=new o.a({delay:.5}),this.start_tween.from([this.progress_wrap,this.progress_inner,this.text_favor],.2,{alpha:0}).from(this.text_tip,.2,{y:"+=20",alpha:0}).addLabel("first").from([this.button_like,this.text_like],.2,{x:"+=20",alpha:0},"first").from([this.button_unlike,this.text_unlike],.2,{x:"-=20",alpha:0},"first").from(this.platform,.4,{y:"+=80",alpha:0},"first").from([this.main_body,this.main_wing],.5,{y:"-=80",alpha:0}).from(this.bannerCont,.2,{y:"+=40",alpha:0}).from(this.hand,.1,{alpha:0}).to(this.hand,.3,{y:"-=15",yoyo:!0,repeat:-1,repeatDelay:.1})},showEnd:function(){var t=this;console.log("game over"),this.cameras.main.fadeIn(200),this.endCont.setVisible(!0),this.selectedNum<5?(this.end_bg.setFrame(1),this.word_again.setText("再选一次")):(this.end_bg.setFrame(0).setTint(10066329),this.selectedPerson.forEach(function(e,i){var n=void 0;(n=i<2?t.add.image(120*(i-.5),0,"body",e):t.add.image(100*(i-3),60,"body",e)).setScale(1.2),t.endMain.add(n)})),this.end_timeline=new o.a({delay:.4}),this.end_timeline.from(this.logo,.2,{y:"-=60",alpha:0}),this.endMain.list.forEach(function(e){t.end_timeline.from(e,.2,{alpha:0,y:"+=60"})}),this.end_timeline.from([this.end_btn_0,this.end_btn_1],.2,{y:"+=60",alpha:0})},handleUserSelect:function(t){var e=this;this.sound.play(),this.hand.visible&&this.hand.setVisible(!1);var i=this.personIndex;if(this.button_like.disableInteractive(),this.button_unlike.disableInteractive(),this.personIndex<=5){o.b.to([this.button_like,this.text_like],.2,{x:"+=40",alpha:0}),o.b.to([this.button_unlike,this.text_unlike],.2,{x:"-=40",alpha:0}),o.b.to(this.platform,.4,{y:"+=60",alpha:0,yoyo:!0,repeat:1,onComplete:function(){}}),this.personIndex++;var n=void 0,s=void 0;if("like"==t){this.selectedNum++,this.selectedNum<=5&&this.selectedPerson.push(i);var a=this.progress_wrap.getBounds(),r=this.add.sprite(this.button_like.x,this.button_like.y,"hand").setVisible(!1);o.b.to(r,.6,{x:a.left+52*(this.selectedNum-1)+26,y:a.centerY}),n=this.prevBodyX,s=this.nextBodyX;var h=this.particles.createEmitter({frame:[0,1,2,3,4,5],speed:300,x:0,y:0,quantity:5,follow:r,lifespan:400+20*this.selectedNum,scale:{start:.8,end:0},deathCallback:function(){e.progress_g.fillRect(a.left,a.top,52*e.selectedNum,30),h.stop(),r.destroy()}})}else n=this.nextBodyX,s=this.prevBodyX;this.personIndex<=5&&(o.b.fromTo([this.username,this.banner_line,this.dragon,this.userdesc],.2,{alpha:1},{alpha:0,yoyo:!0,repeat:1,onRepeat:function(){e.username.setText(d[e.personIndex].username),e.userdesc.setText(d[e.personIndex].desc),e.dragon.setFrame(e.personIndex)}}),o.b.fromTo([this.main_body,this.main_wing],.6,{delay:.2,x:this.mainBodyX},{x:n,ease:"Sine.easeOut",onComplete:function(){e.main_body.setFrame(e.personIndex),e.main_wing.setFrame(e.personIndex),o.b.to([e.button_like,e.text_like],.2,{x:"-=40",alpha:1}),o.b.to([e.button_unlike,e.text_unlike],.2,{x:"+=40",alpha:1}),"end"!=e.status&&(e.button_like.setInteractive(),e.button_unlike.setInteractive())}}),o.b.fromTo([this.next_body,this.next_wing],.6,{delay:.2,x:s},{x:this.mainBodyX,ease:"Sine.easeOut",onStart:function(){e.next_body.setFrame(e.personIndex),e.next_wing.setFrame(e.personIndex)}})),(5==this.selectedNum||this.personIndex>5)&&(this.button_like.disableInteractive(),this.button_unlike.disableInteractive(),this.status="end",this.time.delayedCall(1600,this.showEnd.bind(this)))}},update:function(t,e){},resize:function(t){this.cameras.resize(n,s),this.refreshGame()},refreshGame:function(){this.mainBodyX=.5*n,this.nextBodyX=n+414;var t=n,i=s,a=e.isLandscape;this.bg.setPosition(0,0),this.bg.setDisplaySize(t,a?t/414*736:i),this.main_wing.setPosition(.5*t,.46*i),this.main_body.setPosition(.5*t,.46*i),this.next_wing.setPosition(t+414,.46*i),this.next_body.setPosition(t+414,.46*i),this.button_like.setPosition(.86*t,.46*i),this.button_unlike.setPosition(.14*t,.46*i),this.progress_wrap.setPosition(.5*t+30,.06*i),this.progress_inner.setPosition(.5*t+30,.06*i),this.text_favor.setPosition(this.progress_wrap.x-160,this.progress_wrap.y),this.platform.setPosition(.5*t,.46*i+210),this.text_like.setPosition(this.button_like.x,this.button_like.y),this.text_unlike.setPosition(this.button_unlike.x,this.button_unlike.y),this.bannerCont.setPosition(.5*t,.88*i),this.text_tip.setPosition(this.progress_wrap.x,this.progress_wrap.y+24),this.hand.setPosition(this.button_like.x+20,this.button_like.y+80),this.progress_g.beginPath(),this.progress_g.fillRect(this.progress_wrap.x-130,this.progress_wrap.y-15,52*this.selectedNum,30),this.progress_inner.setMask(this.progress_g.createGeometryMask()),this.end_bg.setPosition(0,0),this.end_bg.setDisplaySize(t,a?t/414*736:i),this.end_btn_0.setPosition(.5*t,.74*i),this.end_btn_1.setPosition(.5*t,.74*i+80),this.logo.setPosition(.5*t,.1*i),this.endMain.setPosition(.5*t,.45*i)},setClickable:function(t){var i=this;t.setInteractive(),t.on("pointerdown",function(){i.sound.play(),o.b.fromTo(t,.1,{alpha:1},{alpha:.7,yoyo:!0,repeat:1})}),t.on("pointerup",function(){e.linkAppStore()})}}),h={type:a.a.AUTO,parent:"canvas",scale:{width:n,height:s,scale:a.a.Scale.None,autoCenter:1},scene:[r],pixelArt:!0,backgroundColor:"#000000"},l=new a.a.Game(h);window.addEventListener("resize",function(){n=t.getCanvasSize().canvasWidth,s=t.getCanvasSize().canvasHeight,l.scale.resize(n,s)},!1)},getCanvasSize:function(){var t=document.body.clientWidth,e=document.body.clientHeight,i=void 0,n=void 0,s=void 0,a=void 0,o=void 0;return t<=e?(s=(i=414)/(n=736),this.isLandscape=!1,t/e>=s?(o=n,a=n*t/e):(o=i/t*e,a=i)):(s=(i=496)/(n=883),this.isLandscape=!0,e/t>=s?(a=n,o=n/t*e):(a=i/e*t,o=i)),console.log("%c canvasWidth:"+~~a+" | canvasHeight:"+~~o+" ","background:#4682B4;color:white;line-height:18px"),{canvasWidth:a,canvasHeight:o}},linkAppStore:function(){var t="ios"===this.userAgent?this.iosUrl:this.androidUrl,e="";parent.postMessage("download","*"),e="vungle",window.install&&window.install(),window.openAppStore&&window.openAppStore(),"undefined"!=typeof dapi?(dapi.openStoreUrl(),e="ironsource"):"undefined"!=typeof FbPlayableAd?(FbPlayableAd.onCTAClick(),e="facebook"):"undefined"!=typeof mraid?(mraid.open(t),e="mraid"):(window.location=t,e="pc"),console.log("%c Platform:"+e+" >>> open store","color:blue")}}},r={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"main"}},[e("div",{attrs:{id:"canvas"}})])}]};var h=i("VU/8")(d,r,!1,function(t){i("gSyW")},null,null).exports;n.a.config.productionTip=!1,new n.a({el:"#app",components:{App:h},template:"<App/>"})},gSyW:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f09e0db05058cb950c03.js.map